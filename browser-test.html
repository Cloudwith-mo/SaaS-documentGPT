<!DOCTYPE html>
<html>
<head><title>DocumentGPT Test</title></head>
<body>
<h1>DocumentGPT API Test</h1>
<div id="results"></div>
<script>
async function testWorkflow() {
    const results = document.getElementById('results');
    
    try {
        // Test 1: Upload
        results.innerHTML += '<p>Testing upload...</p>';
        const uploadResponse = await fetch('https://9voqzgx3ch.execute-api.us-east-1.amazonaws.com/prod/upload', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ filename: 'test.txt', contentType: 'text/plain' })
        });
        const uploadData = await uploadResponse.json();
        results.innerHTML += `<p>‚úÖ Upload: ${uploadData.docId}</p>`;
        
        // Test 2: Chat without context
        results.innerHTML += '<p>Testing chat without context...</p>';
        const chatResponse1 = await fetch('https://9voqzgx3ch.execute-api.us-east-1.amazonaws.com/prod/rag-chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question: 'Hello' })
        });
        const chatData1 = await chatResponse1.json();
        results.innerHTML += `<p>‚úÖ Chat: ${chatData1.hasContext ? 'Has context' : 'No context'}</p>`;
        
        // Test 3: Process document
        results.innerHTML += '<p>Testing document processing...</p>';
        const processResponse = await fetch('https://9voqzgx3ch.execute-api.us-east-1.amazonaws.com/prod/process-document', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                docId: uploadData.docId, 
                filename: 'test.txt', 
                content: 'Tesla was founded in 2003 by Martin Eberhard and Marc Tarpenning.' 
            })
        });
        const processData = await processResponse.json();
        results.innerHTML += `<p>‚úÖ Process: ${processData.status}</p>`;
        
        // Test 4: Chat with context
        results.innerHTML += '<p>Testing chat with context...</p>';
        const chatResponse2 = await fetch('https://9voqzgx3ch.execute-api.us-east-1.amazonaws.com/prod/rag-chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question: 'When was Tesla founded?', docId: uploadData.docId })
        });
        const chatData2 = await chatResponse2.json();
        results.innerHTML += `<p>‚úÖ RAG Chat: ${chatData2.hasContext ? 'Used document context' : 'No context'}</p>`;
        results.innerHTML += `<p><strong>Answer:</strong> ${chatData2.answer}</p>`;
        
        results.innerHTML += '<h2>üéâ All tests passed! DocumentGPT is working!</h2>';
        
    } catch (error) {
        results.innerHTML += `<p>‚ùå Error: ${error.message}</p>`;
    }
}

testWorkflow();
</script>
</body>
</html>