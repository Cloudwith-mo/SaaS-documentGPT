<!DOCTYPE html>
<html>
<head>
    <title>RAG Test</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 50px auto; padding: 20px; }
        button { padding: 10px 20px; margin: 10px 0; cursor: pointer; }
        textarea { width: 100%; height: 100px; margin: 10px 0; }
        #output { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; white-space: pre-wrap; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üß™ RAG Test Page</h1>
    
    <h3>1. Upload Document</h3>
    <textarea id="content" placeholder="Enter document content...">Artificial Intelligence is transforming technology. Machine learning enables computers to learn from data.</textarea>
    <button onclick="uploadDoc()">Upload</button>
    
    <h3>2. Ask Question</h3>
    <input type="text" id="query" placeholder="What is AI?" style="width: 70%; padding: 10px;">
    <button onclick="askQuestion()">Ask</button>
    
    <h3>Output:</h3>
    <div id="output">Ready...</div>

    <script>
        const API_URL = 'https://w6poeb2pzi5v6lglx5jbygv3uu0uarkd.lambda-url.us-east-1.on.aws';
        
        async function uploadDoc() {
            const content = document.getElementById('content').value;
            const output = document.getElementById('output');
            output.innerHTML = 'Uploading...';
            
            try {
                const res = await fetch(`${API_URL}/dev/upload`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: 'test_user',
                        filename: 'test.txt',
                        content: content
                    })
                });
                const data = await res.json();
                output.innerHTML = `<span class="success">‚úÖ Uploaded!</span>\n${JSON.stringify(data, null, 2)}`;
            } catch (e) {
                output.innerHTML = `<span class="error">‚ùå Error: ${e.message}</span>`;
            }
        }
        
        async function askQuestion() {
            const query = document.getElementById('query').value;
            const output = document.getElementById('output');
            output.innerHTML = 'Thinking...';
            
            try {
                const res = await fetch(`${API_URL}/dev/chat`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({query})
                });
                const data = await res.json();
                output.innerHTML = `<span class="success">‚úÖ Answer:</span>\n${data.response}\n\n<strong>Citations:</strong>\n${JSON.stringify(data.citations, null, 2)}`;
            } catch (e) {
                output.innerHTML = `<span class="error">‚ùå Error: ${e.message}</span>`;
            }
        }
    </script>
</body>
</html>
